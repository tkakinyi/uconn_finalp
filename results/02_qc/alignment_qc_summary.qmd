---
title: "AlignementQC"
format: html
editor: visual
toc: true
---

## Alignment

A concatenation of the both the human and SARS-CoV2 genomes was indexed using bwa-mem2 v.2.1. The concatenation is in lieu of active filtering of the raw waster reads against the human genome. This step will let the reads that are human align to the human genome and the viral to the viral genome, essentially filtering. The reads were the aligned with bwa-mem2, samtools v1.16.1 and samblasterv0.1.24. Samblaster was used to mark duplicate read pairs and flag them for elimination in downstream analysis.

## Alignment QC

Alignment QC steps include using samtoolsv1.16.1 to calculate the statistics for each resultant bam file and mutliqc v1.9 to summarize these. @tbl-oneqc and @fig-alignqc

+--------------------------------------------------------------------------------------------+
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | Sample Name | Error rate | M Reads Mapped | \% Mapped | \% Proper Pairs | M Total seqs | |
| +:============+:===========+:===============+:==========+:================+:=============+ |
| | SRR16004596 | 0.00%      | 0.0            | 100.0%    | 0.0%            | 0.0          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004634 | 0.33%      | 0.0            | 100.0%    | 0.0%            | 0.0          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004623 | 0.35%      | 0.2            | 99.8%     | 99.4%           | 0.2          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004552 | 0.36%      | 0.5            | 99.7%     | 99.4%           | 0.5          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004590 | 0.33%      | 0.3            | 99.7%     | 99.5%           | 0.3          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004581 | 0.35%      | 0.5            | 99.6%     | 98.8%           | 0.5          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004577 | 0.18%      | 0.7            | 99.5%     | 99.4%           | 0.7          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004614 | 0.19%      | 0.6            | 99.4%     | 99.3%           | 0.6          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004573 | 0.40%      | 0.3            | 99.3%     | 99.1%           | 0.3          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004620 | 0.32%      | 1.0            | 99.3%     | 99.3%           | 1.0          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004570 | 0.37%      | 0.3            | 99.2%     | 99.1%           | 0.3          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004591 | 0.32%      | 0.6            | 99.2%     | 99.1%           | 0.6          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004631 | 0.32%      | 0.9            | 99.2%     | 99.1%           | 0.9          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004635 | 0.17%      | 0.3            | 99.2%     | 99.1%           | 0.3          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004576 | 0.19%      | 0.7            | 99.1%     | 98.9%           | 0.7          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004613 | 0.18%      | 0.3            | 99.1%     | 99.0%           | 0.3          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004558 | 0.37%      | 0.6            | 99.0%     | 98.9%           | 0.6          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004612 | 0.41%      | 0.2            | 98.9%     | 98.7%           | 0.2          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004619 | 0.32%      | 0.5            | 98.9%     | 98.7%           | 0.5          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004632 | 0.32%      | 0.8            | 98.9%     | 98.7%           | 0.8          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004555 | 0.30%      | 1.1            | 98.8%     | 98.6%           | 1.1          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004565 | 0.41%      | 0.2            | 98.8%     | 98.6%           | 0.2          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004578 | 0.19%      | 0.5            | 98.8%     | 98.7%           | 0.5          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004601 | 0.31%      | 1.5            | 98.8%     | 98.7%           | 1.5          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004642 | 0.37%      | 0.6            | 98.8%     | 98.6%           | 0.6          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004554 | 0.31%      | 1.2            | 98.7%     | 98.6%           | 1.2          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004566 | 0.19%      | 0.2            | 98.7%     | 98.3%           | 0.2          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004553 | 0.31%      | 0.9            | 98.6%     | 98.5%           | 0.9          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004560 | 0.32%      | 0.1            | 98.6%     | 98.1%           | 0.1          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004603 | 0.19%      | 0.5            | 98.6%     | 98.5%           | 0.5          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004606 | 0.20%      | 0.4            | 98.6%     | 98.5%           | 0.4          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004646 | 0.32%      | 0.8            | 98.6%     | 98.5%           | 0.8          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004588 | 0.32%      | 0.9            | 98.4%     | 98.3%           | 0.9          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004604 | 0.27%      | 0.5            | 98.4%     | 98.2%           | 0.5          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004624 | 0.44%      | 0.1            | 98.4%     | 97.9%           | 0.1          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004643 | 0.31%      | 0.9            | 98.4%     | 98.3%           | 1.0          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004628 | 0.27%      | 0.0            | 98.3%     | 96.6%           | 0.0          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004630 | 0.37%      | 0.4            | 98.3%     | 98.2%           | 0.4          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004644 | 0.36%      | 0.9            | 98.2%     | 98.1%           | 0.9          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004593 | 0.37%      | 0.3            | 98.1%     | 98.0%           | 0.4          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004633 | 0.20%      | 0.5            | 98.0%     | 97.9%           | 0.6          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004559 | 0.35%      | 0.3            | 97.8%     | 97.7%           | 0.4          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004575 | 0.35%      | 0.3            | 97.8%     | 97.4%           | 0.3          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004556 | 0.19%      | 0.3            | 97.7%     | 97.6%           | 0.3          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004621 | 0.29%      | 0.9            | 97.7%     | 97.1%           | 0.9          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004561 | 0.35%      | 0.5            | 97.6%     | 97.5%           | 0.5          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004602 | 0.35%      | 0.6            | 97.6%     | 97.4%           | 0.6          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004611 | 0.35%      | 0.3            | 97.6%     | 97.5%           | 0.3          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004574 | 0.37%      | 0.2            | 97.4%     | 97.2%           | 0.2          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004645 | 0.31%      | 0.4            | 97.4%     | 97.1%           | 0.4          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004625 | 0.18%      | 0.6            | 97.2%     | 97.1%           | 0.7          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004610 | 0.35%      | 0.9            | 97.0%     | 96.7%           | 0.9          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004589 | 0.29%      | 1.1            | 96.9%     | 96.8%           | 1.2          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004572 | 0.32%      | 0.5            | 96.2%     | 95.9%           | 0.5          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004592 | 0.36%      | 0.3            | 96.2%     | 96.1%           | 0.3          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004598 | 0.18%      | 0.8            | 95.5%     | 95.4%           | 0.8          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004626 | 0.28%      | 1.0            | 94.0%     | 93.9%           | 1.1          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004608 | 0.32%      | 0.7            | 93.3%     | 93.2%           | 0.7          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004622 | 0.32%      | 0.0            | 93.0%     | 80.0%           | 0.0          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004562 | 0.18%      | 0.1            | 92.5%     | 92.4%           | 0.1          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004641 | 0.29%      | 0.8            | 92.1%     | 92.0%           | 0.9          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004615 | 0.35%      | 0.0            | 89.5%     | 76.5%           | 0.0          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004617 | 0.23%      | 0.2            | 89.3%     | 89.1%           | 0.2          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004616 | 0.18%      | 0.2            | 88.6%     | 88.4%           | 0.3          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004605 | 0.48%      | 0.0            | 87.9%     | 71.0%           | 0.0          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004609 | 0.54%      | 0.0            | 80.3%     | 76.2%           | 0.0          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004568 | 0.30%      | 0.1            | 79.9%     | 79.8%           | 0.1          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004585 | 0.25%      | 0.2            | 76.2%     | 75.9%           | 0.2          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004594 | 0.66%      | 0.0            | 74.9%     | 68.7%           | 0.0          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004629 | 0.30%      | 0.1            | 74.9%     | 74.5%           | 0.1          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004580 | 0.19%      | 0.5            | 72.6%     | 72.5%           | 0.7          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004569 | 0.31%      | 0.1            | 70.7%     | 70.6%           | 0.1          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004567 | 1.08%      | 0.0            | 70.0%     | 0.0%            | 0.0          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004571 | 0.52%      | 0.1            | 67.8%     | 67.4%           | 0.1          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004600 | 0.20%      | 0.3            | 64.8%     | 64.7%           | 0.5          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004557 | 0.32%      | 0.1            | 64.6%     | 64.2%           | 0.1          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004586 | 0.33%      | 0.1            | 63.1%     | 62.9%           | 0.2          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004607 | 0.37%      | 0.1            | 61.2%     | 61.1%           | 0.1          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004639 | 0.37%      | 0.1            | 60.1%     | 60.0%           | 0.2          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004584 | 0.33%      | 0.1            | 58.7%     | 58.6%           | 0.2          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004627 | 0.13%      | 0.0            | 57.1%     | 0.0%            | 0.0          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004583 | 0.33%      | 0.0            | 55.4%     | 54.7%           | 0.0          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004595 | 0.36%      | 0.0            | 54.5%     | 0.0%            | 0.0          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004636 | 0.18%      | 0.3            | 52.8%     | 52.7%           | 0.6          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004564 | 0.36%      | 0.0            | 47.3%     | 47.2%           | 0.1          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004648 | 0.16%      | 0.2            | 47.3%     | 47.2%           | 0.4          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004587 | 0.35%      | 0.0            | 44.2%     | 44.1%           | 0.1          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004599 | 0.19%      | 0.2            | 43.7%     | 43.6%           | 0.5          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004638 | 0.34%      | 0.1            | 41.3%     | 41.2%           | 0.1          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004637 | 0.18%      | 0.2            | 37.0%     | 36.9%           | 0.5          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004647 | 0.14%      | 0.2            | 36.9%     | 36.8%           | 0.5          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004582 | 0.13%      | 0.1            | 36.0%     | 36.0%           | 0.4          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004563 | 0.39%      | 0.1            | 34.1%     | 34.0%           | 0.2          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004618 | 0.37%      | 0.1            | 29.3%     | 29.3%           | 0.2          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004640 | 0.48%      | 0.0            | 24.6%     | 24.6%           | 0.1          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004579 | 0.26%      | 0.0            | 5.5%      | 5.5%            | 0.4          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
| | SRR16004597 | 0.00%      | 0.0            |           |                 | 0.0          | |
| +-------------+------------+----------------+-----------+-----------------+--------------+ |
+============================================================================================+
|                                                                                            |
+--------------------------------------------------------------------------------------------+

: Table showing statistics of the alignment of raw waster water reads to the combined reference genome (human and viral). {#tbl-oneqc}

::: {#fig-alignqc layout-ncol="1"}
![](images/fig3.png){#fig2}

Figure showing the mapping rate of waste water samples to the combined reference genome (viral and human).
:::

The raw reads show decent alignment scores, with majority of the reads mapping at \>57% and only 16 out of 97 samples mapping below that; aligned with maximal error rate of 1.08%.
